# Shared helper functions for simulation logic